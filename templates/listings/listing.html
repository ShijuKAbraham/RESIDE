{% extends 'base.html' %}

{% load humanize %}

{% block content %}

<section id="showcase-inner" class="py-5 text-white">
        <div class="container">
          <div class="row text-center">
            <div class="col-md-12">
              <h1 class="display-4">{{ listing.title }}</h1>
              <p class="lead">
                <i class="fas fa-map-marker"></i> {{ listing.address}}</p>
            </div>
          </div>
        </div>
</section>

<!-- Breadcrum -->

<section id="bc" class="mt-3">
        <div class="container">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item">
                <a href="{% url 'index' %}">
                  <i class="fas fa-home"></i> Home</a>
              </li>
              <li class="breadcrumb-item">
                    <a href="{% url 'listings' %}">
                      <i class="fas fa-caret-right"></i> Listings</a>
                  </li>
              <li class="breadcrumb-item active"> Browse Listing</li>
            </ol>
          </nav>
        </div>
      </section>
<!-- End of Breadcrumb -->
<br>
	<!-- START SECTION PROPERTIES LISTING -->
	<section class="blog details"  onscroll="initMap()">
		<div class="container">
			<div class="row">
				<div class="col-lg-9 col-md-12 blog-pots">
					<!-- Block heading Start-->
					<div class="block-heading details">
						<div class="row">
							<div class="col-lg-7">
								<h3>
									<span class="heading-icon">
										<i class="fa fa-map-marker"></i>
									</span>
									<span class="hidden-sm-down">{{ listing.city}} {{ listing.state}} {{ listing.zipcode}}</span>
								</h3>
							</div>
							<div class="col-lg-3 cod-pad">
								<div class="sorting-options">
									<h4><span>Price:</span> â‚¹ {{ listing.price}}</h4>
								</div>
							</div>
						</div>
					</div>
					<!-- Block heading end -->
					<div class="row">
						<div class="col-md-12 mb-4">
							<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
								<ol class="carousel-indicators">
									<li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
									<li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
									<li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
									<li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
								</ol>
								<div class="carousel-inner" role="listbox">
                                    
									<div class="carousel-item active">
										<img class="d-block img-fluid" src="{{ listing.photo_main.url }}" alt="First slide">
                                    </div>
                                    {% if listing.photo_1 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_1.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
									{% if listing.photo_2 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_2.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
                                    {% if listing.photo_3 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_3.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
                                    {% if listing.photo_4 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_4.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
                                    {% if listing.5 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_5.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
                                    {% if listing.photo_6 %}
									<div class="carousel-item">
										<img class="d-block img-fluid" src="{{ listing.photo_6.url }}" alt="Second slide">
                                    </div>
                                    {% endif %}
								</div>
								<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="sr-only">Previous</span>
								</a>
								<a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="sr-only">Next</span>
								</a>
							</div>
							<div class="container coursel_beneath">
									<div class="row">
											<div class="col">
												  <i class="fa fa-object-group" aria-hidden="true"></i>
												  <span>Sqft: {{ listing.sqft }}</span>
											</div>
											<div class="col">
												  <i class="fa fa-car" aria-hidden="true"></i>
												  <span>Garage: {{ listing.garage }}</span>
											</div>
											<div class="col">
												  <i class="fa fa-clone" aria-hidden="true"></i>
												  <span>Balcony: {{ listing.balcony }}</span>
											</div>
									</div>
									<br>
									<div class="row">
									  <div class="col">
											<i class="fa fa-bed" aria-hidden="true"></i>
											<span>Bedrooms: {{ listing.bedrooms }}</span>
									  </div>
									  <div class="col">
											<i class="fa fa-bath" aria-hidden="true"></i>
											<span>Bathrooms: {{ listing.bathrooms }}</span>
									  </div>
									</div>
									
							</div>
								
								<br>
								<div class="homes-content details mb-5">
									<h5 class="mb-4">GENERAL INFORMATION</h5>
									<p class="mb-3">{{ listing.description }}</p>
								</div>
							
						</div>
					</div>
					<div class=" container homes-content details aminities mb-5">
						<!-- title -->
						<h5 class="mb-4">Amenities</h5>
						<!-- cars List -->
						<ul class="homes-list clearfix">
							{% if listing.water_supply %}
							<li>
								<i class="fa fa-check-square" aria-hidden="true"></i>
								<span>WATER SUPPLY</span>
							</li>
							{% else %}
							<li>
									<i class="fa fa-window-close"" aria-hidden="true"></i>
									<span>WATER SUPPLY</span>
								</li>
							{% endif %}
							{% if listing.pool %}
							<li>
								<i class="fa fa-check-square" aria-hidden="true"></i>
								<span>POOL</span>
							</li>
							{% else %}
							<li>
									<i class="fa fa-window-close"" aria-hidden="true"></i>
									<span>POOL</span>
								</li>
							{% endif %}
							{% if listing.lawn %}
							<li>
								<i class="fa fa-check-square" aria-hidden="true"></i>
								<span>LAWN</span>
							</li>
							{% else %}
							<li>
									<i class="fa fa-window-close"" aria-hidden="true"></i>
									<span>LAWN</span>
							</li>
							{% endif %}
							{% if listing.furnished %}
							<li>
								<i class="fa fa-check-square" aria-hidden="true"></i>
								<span>FURNISHED</span>
							</li>
							{% else %}
							<li>
									<i class="fa fa-window-close"" aria-hidden="true"></i>
									<span>FURNISHED</span>
								</li>
							{% endif %}
							{% if listing.water_heater %}
							<li>
								<i class="fa fa-check-square" aria-hidden="true"></i>
								<span>WATER HEATER</span>
							</li>
							{% else %}
							<li>
									<i class="fa fa-window-close"" aria-hidden="true"></i>
									<span>WATER HEATER</span>
							</li>
							{% endif %}
							<li>
									<i class="fa fa-delicious" aria-hidden="true"></i>
									<span>{{ listing.tile_type }}</span>
							</li>
						</ul>
					</div>
					<div class="container">
							<video width="100%" height="50%" controls>
									<source src="{{ listing.video.url }}" type="video/mp4">
							</video>
					</div>
					<br>
					<div class="container homes-content details mb-5">
						<h5>Location</h5>
						<div class="divider-fade"></div>
							<div id="map">
								<input type="text" id="lat" name="lat" value="{{ listing.latitude }}" />
								<input type="text" id="lng" name="lng" value="{{ listing.longtitude }}" />
								<input type="text" id="type" name="type" value="{{ listing.house_type }}" />
							</div>
							<br><br><br><br><br>
							<h5>Street View</h5>
							<div id="pano"></div>	
							<script>
								function initMap() {
									
									let lati=document.getElementById('lat').value;
									let lngi=document.getElementById('lng').value;
									var h_type=document.getElementById('type').value;
									lati = parseFloat(lati);
									lngi = parseFloat(lngi);
									
									var uluru = {lat: lati, lng: lngi};
									var house_url = "https://cdn0.iconfinder.com/data/icons/map-and-navigation-2-1/48/100-512.png";
									var apartment_url = "https://keelty.com/wp-content/uploads/2017/05/apartment-poi-icon-01.png";
									var main_url;
									var result = h_type.localeCompare("Independent");
									if(result === 1)
									{
										main_url = house_url;
									}
									else
									{
										main_url = apartment_url;
									}
									

									// The map, centered at Uluru
									
									  var map = new google.maps.Map(document.getElementById('map'), {
										  zoom: 14,
										  center: uluru,
										  gestureHandling: 'cooperative',
										  mapTypeId: 'satellite',
										  heading: 90,
										  tilt:45

										});
									map.setTilt(45);
									function rotate90() {
										var heading = map.getHeading() || 0;
										map.setHeading(heading + 90);
									  }
									  
									function autoRotate() {
										// Determine if we're showing aerial imagery.
										if (map.getTilt() !== 0) {
										  window.setInterval(rotate90, 3000);
										}
									  }
									var icon = {
									  url: main_url, // url
									  scaledSize: new google.maps.Size(50, 50), // scaled size
								  };
									// The marker, positioned at Uluru
									var marker = new google.maps.Marker({
										position: uluru, 
										map: map, 
										icon: icon,
										title: 'Click to zoom'});
								
										map.addListener('center_changed', function() {
										  // 3 seconds after the center of the map has changed, pan back to the
										  // marker.
										  window.setTimeout(function() {
											map.panTo(marker.getPosition());
										  }, 3000);
										});
								
										marker.addListener('click', function() {
										  map.setZoom(20);
										  map.setCenter(marker.getPosition());
										});
										var panorama = new google.maps.StreetViewPanorama(
										  document.getElementById('pano'), {
										  position: uluru,
										  pov: {
											  heading: 34,
											  pitch: 10
										  }
										  });
									  map.setStreetView(panorama);
										  
								
								  }
							</script>
							<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_kua5kkwDTNktIoWp1vsbRzZfjqfCc0U&callback=initMap">
							</script>		
					</div>	
					<br>	
				</div>	
				<div class="col-md-3">
					<div class="card mb-3">
					  <img class="card-img-top" src="{{ listing.realtor.photo.url }}">
					  <div class="card-body text-center">
						<h5 class="card-title">Property Realtor</h5>
						<h6 class="text-secondary">{{ listing.realtor }}</h6>
					  </div>
					</div>
					<button class="btn-primary btn-block btn-lg" data-toggle="modal" data-target="#inquiryModal">Make An Inquiry</button>
				  </div>			
			</div>
		</div>
	</section>
	<br><br><br>
	<!-- END SECTION PROPERTIES LISTING -->
{% endblock %}